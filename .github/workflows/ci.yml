name: ğŸš€ Node.js CI with Docker

on:
  push:
    branches: [ main ]  # à¸—à¸³à¸‡à¸²à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µ push à¹„à¸›à¸—à¸µà¹ˆ main

jobs:
  build:
    runs-on: ubuntu-latest  # à¹ƒà¸Šà¹‰ runner à¹€à¸›à¹‡à¸™ Ubuntu à¸¥à¹ˆà¸²à¸ªà¸¸à¸”

    steps:
    # âœ… à¸”à¸¶à¸‡à¸‹à¸­à¸£à¹Œà¸ªà¹‚à¸„à¹‰à¸”à¸ˆà¸²à¸ GitHub Repo
    - name: ğŸ“¥ Checkout Repository
      uses: actions/checkout@v4

    # âœ… à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ Node.js à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™ 18
    - name: ğŸŸ¢ Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'

    # âœ… à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies à¸ˆà¸²à¸ package.json
    - name: ğŸ“¦ Install dependencies
      run: npm install

    # âœ… à¸£à¸±à¸™ test (à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸ˆà¸£à¸´à¸‡)
    - name: âœ… Run tests
      run: echo "No tests yet"

    # âœ… à¸ªà¸£à¹‰à¸²à¸‡ Docker image à¸ˆà¸²à¸ Dockerfile
    - name: ğŸ³ Build Docker image
      run: docker build -t dragonfore4/simple-login-express:v1 .

    # ğŸ“ (à¹€à¸¥à¸·à¸­à¸à¹ƒà¸Šà¹‰) Push Docker image à¹„à¸›à¸—à¸µà¹ˆ Docker Hub
    - name: Login to Docker Hub
      uses: docker/login-action@v3
      with:
        username: ${{ secrets.DOCKER_USERNAME }}  # à¹ƒà¸Šà¹‰ secrets à¸ªà¸³à¸«à¸£à¸±à¸š username
        password: ${{ secrets.DOCKER_PASSWORD }}  # à¹ƒà¸Šà¹‰ secrets à¸ªà¸³à¸«à¸£à¸±à¸š password

    - name: ğŸ“¤ Push Docker image
      run: docker push dragonfore4/simple-login-express:v1
